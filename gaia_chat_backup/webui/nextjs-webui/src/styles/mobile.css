/* Mobile Optimization Styles */

/* iOS Safe Area Support */
@supports (padding: env(safe-area-inset-top)) {
  .safe-area-top {
    padding-top: env(safe-area-inset-top);
  }
  
  .safe-area-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  .safe-area-left {
    padding-left: env(safe-area-inset-left);
  }
  
  .safe-area-right {
    padding-right: env(safe-area-inset-right);
  }
  
  .safe-area-all {
    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
  }
}

/* 터치 최적화 */
.touch-optimized {
  /* iOS 더블탭 줌 방지 */
  touch-action: manipulation;
  
  /* 터치 하이라이트 제거 (iOS Safari) */
  -webkit-tap-highlight-color: transparent;
  
  /* 텍스트 선택 방지 */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

/* 터치 가능한 요소의 최소 크기 (44px x 44px) */
.touch-target {
  min-height: 44px;
  min-width: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* 모바일 입력 최적화 */
.mobile-input {
  /* iOS 줌 방지를 위한 최소 폰트 크기 */
  font-size: 16px;
  
  /* iOS 입력 필드 스타일 리셋 */
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  
  /* iOS Safari 그림자 제거 */
  border-radius: 0;
  
  /* 자동완성 스타일 커스터마이징 */
  &:-webkit-autofill {
    -webkit-box-shadow: 0 0 0 30px var(--input-bg) inset !important;
    -webkit-text-fill-color: var(--text-color) !important;
  }
}

/* 모바일 스크롤 최적화 */
.mobile-scroll {
  /* iOS 관성 스크롤 */
  -webkit-overflow-scrolling: touch;
  
  /* 스크롤바 숨김 */
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* IE 10+ */
  
  &::-webkit-scrollbar {
    display: none; /* Webkit browsers */
  }
}

/* 모바일 키보드 대응 */
.keyboard-avoiding {
  /* 키보드가 올라올 때 뷰포트 조정 */
  height: 100vh;
  height: 100dvh; /* Dynamic viewport height */
  
  @supports (height: 100dvh) {
    height: 100dvh;
  }
}

/* 햅틱 피드백 애니메이션 */
.haptic-light {
  animation: haptic-light 0.1s ease-out;
}

.haptic-medium {
  animation: haptic-medium 0.15s ease-out;
}

.haptic-heavy {
  animation: haptic-heavy 0.2s ease-out;
}

@keyframes haptic-light {
  0% { transform: scale(1); }
  50% { transform: scale(0.98); }
  100% { transform: scale(1); }
}

@keyframes haptic-medium {
  0% { transform: scale(1); }
  50% { transform: scale(0.95); }
  100% { transform: scale(1); }
}

@keyframes haptic-heavy {
  0% { transform: scale(1); }
  25% { transform: scale(0.92); }
  50% { transform: scale(0.95); }
  75% { transform: scale(0.98); }
  100% { transform: scale(1); }
}

/* 리플 효과 */
.ripple {
  position: relative;
  overflow: hidden;
}

.ripple::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  transform: translate(-50%, -50%);
  pointer-events: none;
  opacity: 0;
  z-index: 1;
}

.ripple.active::before {
  animation: ripple-effect 0.6s ease-out;
}

@keyframes ripple-effect {
  0% {
    width: 0;
    height: 0;
    opacity: 1;
  }
  100% {
    width: 300px;
    height: 300px;
    opacity: 0;
  }
}

/* 스와이프 인디케이터 */
.swipe-indicator {
  position: relative;
  overflow: hidden;
}

.swipe-indicator::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(
    90deg,
    transparent,
    rgba(59, 130, 246, 0.5),
    transparent
  );
  animation: swipe-indicator 2s ease-in-out infinite;
  z-index: 1;
}

/* PWA 지원 */
@media (display-mode: standalone) {
  .pwa-only {
    display: block;
  }
  
  .browser-only {
    display: none;
  }
}

@media not (display-mode: standalone) {
  .pwa-only {
    display: none;
  }
  
  .browser-only {
    display: block;
  }
}

/* 다크모드 대응 */
@media (prefers-color-scheme: dark) {
  :root {
    --input-bg: rgb(31, 41, 55);
    --text-color: rgb(243, 244, 246);
  }
}

@media (prefers-color-scheme: light) {
  :root {
    --input-bg: rgb(255, 255, 255);
    --text-color: rgb(17, 24, 39);
  }
}

/* 접근성 개선 */
@media (prefers-reduced-motion: reduce) {
  .motion-reduce {
    animation: none !important;
    transition: none !important;
  }
}

/* 고대비 모드 */
@media (prefers-contrast: high) {
  .high-contrast {
    border: 2px solid;
    background: transparent;
  }
}

/* 폰트 크기 조정 */
@media (prefers-reduced-data: reduce) {
  .data-saver {
    background: none;
    box-shadow: none;
    text-shadow: none;
  }
}

/* 모바일 가로/세로 방향 대응 */
@media (orientation: portrait) {
  .portrait-only {
    display: block;
  }
  
  .landscape-only {
    display: none;
  }
}

@media (orientation: landscape) {
  .portrait-only {
    display: none;
  }
  
  .landscape-only {
    display: block;
  }
  
  /* 가로 모드에서 키보드 공간 최적화 */
  .landscape-keyboard-avoiding {
    max-height: 50vh;
  }
}

/* iPhone X 시리즈 Safe Area 최적화 */
@media only screen 
  and (device-width: 375px) 
  and (device-height: 812px) 
  and (-webkit-device-pixel-ratio: 3) {
  .iphone-x-safe {
    padding-top: 44px;
    padding-bottom: 34px;
  }
}

/* 폴더블 디바이스 대응 */
@media (spanning: single-fold-vertical) {
  .fold-vertical {
    display: flex;
    flex-direction: row;
  }
}

@media (spanning: single-fold-horizontal) {
  .fold-horizontal {
    display: flex;
    flex-direction: column;
  }
}